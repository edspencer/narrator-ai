"use strict";(self.webpackChunkdocs_2=self.webpackChunkdocs_2||[]).push([[291],{7407:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var o=n(4848),a=n(8453);const i={sidebar_position:4,title:"Training Narrator"},r="Training",s={id:"training",title:"Training Narrator",description:"Spending 5 minutes to train Narrator is likely to significantly improve your results. Training just means giving a good/bad verdict to a piece of content that Narrator generated. Narrator saves this verdict, along with an optional reason (you don't have to give a reason, but it's a good idea), and next time it generates content for you it will use those good/bad examples to produce a better response.",source:"@site/docs/training.md",sourceDirName:".",slug:"/training",permalink:"/narrator-ai/training",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,title:"Training Narrator"},sidebar:"docs",previous:{title:"Rendering Content",permalink:"/narrator-ai/rendering"},next:{title:"Configuration",permalink:"/narrator-ai/configuration"}},d={},c=[{value:"Training in the CLI",id:"training-in-the-cli",level:3},{value:"Training in the UI",id:"training-in-the-ui",level:3}];function l(e){const t={a:"a",code:"code",h1:"h1",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"training",children:"Training"})}),"\n",(0,o.jsx)(t.p,{children:"Spending 5 minutes to train Narrator is likely to significantly improve your results. Training just means giving a good/bad verdict to a piece of content that Narrator generated. Narrator saves this verdict, along with an optional reason (you don't have to give a reason, but it's a good idea), and next time it generates content for you it will use those good/bad examples to produce a better response."}),"\n",(0,o.jsxs)(t.p,{children:["Under the covers, Narrator uses Few Shot Prompting to grab a selection of the content examples you marked as good or bad, and automatically passes them to the LLM along with your prompt when you call ",(0,o.jsx)(t.code,{children:"generate"}),"."]}),"\n",(0,o.jsxs)(t.p,{children:["Training is done via the ",(0,o.jsx)(t.code,{children:"train"})," and ",(0,o.jsx)(t.code,{children:"saveExample"})," functions, and is easy to hook up to the command line, and even easier to hook up to your UI if you use ",(0,o.jsx)(t.a,{href:"https://www.npmjs.com/package/@narrator-ai/react",children:"@narrator-ai/react"}),"."]}),"\n",(0,o.jsx)(t.h3,{id:"training-in-the-cli",children:"Training in the CLI"}),"\n",(0,o.jsxs)(t.p,{children:["Let's provide an ",(0,o.jsx)(t.code,{children:"examplesDir"})," to our Narrator this time:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-tsx",children:'//this time we configured an examplesDir to tell Narrator where to save good/bad examples\nexport const narrator = new Narrator({\n  outputFilename: (docId) => `${docId}.md`,\n  outputDir: path.join(process.cwd(), "editorial"),\n  examplesDir: path.join(process.cwd(), "editorial", "examples"),\n});\n'})}),"\n",(0,o.jsx)(t.p,{children:"Here's a simple script I use to train Narrator on content that it generates for my post outros GenerationTasks:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-ts",children:'//expose the OPENAI_API_KEY\nimport * as dotenv from "dotenv";\ndotenv.config();\n\nimport { TaskFactory, narrator } from "@/lib/blog/TaskFactory";\nimport Posts from "@/lib/blog/Posts";\n\nasync function main() {\n  const taskFactory = new TaskFactory();\n  const posts = new Posts();\n\n  for (const post of posts.publishedPosts) {\n    await narrator.train(taskFactory.jobForId("post/" + post.slug));\n  }\n}\n\nmain()\n  .catch(console.error)\n  .then(() => process.exit(0));\n'})}),"\n",(0,o.jsxs)(t.p,{children:["That's pretty basic. We're just looping over each published post, creating a GenerationTask (docId + prompt) for each, and passing it in to the ",(0,o.jsx)(t.code,{children:"train"})," function, which is optimized for CLI-based training. It will generate content and ask you to give it a good/bad rating, or skip it. It will also ask you for a reason why you gave that rating."]}),"\n",(0,o.jsx)(t.p,{children:"Here's the actual shell output from running this:"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Training via the CLI",src:n(4979).A+"",width:"720",height:"399"})}),"\n",(0,o.jsxs)(t.p,{children:["It will keep doing that until it runs out of published posts to generate content for, or you ctrl-c out of it. Note that all this is doing is saving good/bad examples, calling ",(0,o.jsx)(t.code,{children:"train"})," does generate text, but it won't save it as the actual text for the given docId."]}),"\n",(0,o.jsxs)(t.p,{children:["Note that each of the examples above will be saved under the ",(0,o.jsx)(t.code,{children:"post"})," key - internally, Narrator takes everything before the ",(0,o.jsx)(t.code,{children:"/"})," in the ",(0,o.jsx)(t.code,{children:"docId"})," (if there is one) and treats that as a group. Above, we trained by generating content for ",(0,o.jsx)(t.code,{children:"post/read-next-ai-content-recommendations-node"})," and ",(0,o.jsx)(t.code,{children:"post/ai-content-recommendations-typescript"}),", and the verdicts and optional reasons we supplied were saved under the ",(0,o.jsx)(t.code,{children:"post"})," key. Next time we either ",(0,o.jsx)(t.code,{children:"generate"})," or ",(0,o.jsx)(t.code,{children:"train"})," on a ",(0,o.jsx)(t.code,{children:"docId"})," that starts with ",(0,o.jsx)(t.code,{children:"post/"}),", Narrator will grab some or all of those good/bad examples and pass them to the LLM to tell it what we like and don't like."]}),"\n",(0,o.jsx)(t.p,{children:"The performance of the LLM in generating the type of content you want goes up significantly even after only training on a few examples. You only have to do it once; under the covers the examples are saved as .yml files and should be committed to source control."}),"\n",(0,o.jsx)(t.h3,{id:"training-in-the-ui",children:"Training in the UI"}),"\n",(0,o.jsxs)(t.p,{children:["If you are using ",(0,o.jsx)(t.a,{href:"https://www.npmjs.com/package/@narrator-ai/react",children:"@narrator-ai/react"}),", you can train Narrator directly in your UI while you're developing. This is perhaps even easier than doing it via the CLI, and has the benefit of showing you the fully rendered content in the actual context it will be shown in inside your UI."]}),"\n",(0,o.jsx)(t.p,{children:"If you set up your Narrator provider like shown above, you can now train directly in your UI by just clicking the thumbs up/down buttons and optionally providing a reason for your selection. The outcome is exactly the same as in the CLI, but this is more fun:"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Training via the UI",src:n(1637).A+"",width:"720",height:"168"})})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},1637:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/Narration-training-a00a9f44867a9f115083c8db174c7c40.gif"},4979:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/training-example-a7b04e4b22e8ab90c384d33a7e44a6e7.gif"},8453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>s});var o=n(6540);const a={},i=o.createContext(a);function r(e){const t=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),o.createElement(i.Provider,{value:t},e.children)}}}]);